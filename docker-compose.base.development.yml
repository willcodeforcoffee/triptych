version: '3'
services:
  web:
    command: bin/start
    tty: true
    stdin_open: true
    env_file:
      - .env
    environment:
      - "RAILS_YARN_INTEGRITY_CHECK=true"
    volumes:
      - .:/triptych
      - ./docker/data/web/tmp:/triptych/tmp
      - ./docker/data/web/log:/triptych/log
      - ./docker/data/web/bundle:/usr/local/bundle
      - ./docker/data/web/node_modules:/triptych/node_modules
  db:
    env_file:
      - .env
    environment:
      - "POSTGRES_USER=postgres"
      - "POSTGRES_PASSWORD=postgres"
    volumes:
      - ./docker/data/db:/var/lib/postgresql/data
  redis:
    env_file:
      - .env
    volumes:
      - ./docker/data/redis:/data
